{"md":[{"md":[],"t":"tr","msg":"チュートリアル「売上明細表」 を作成します\r\nこのサンプルの完成イメージと、より詳細な説明は \r\n\r\nhttp://rapidreport.systembase.co.jp/example2.html \r\n\r\nにあります"},{"t":"r","msg":"(レポート)に \"売上明細表\" という見出しを付けます","in":{"t":"m","v":"売上明細表","or":1,"k":"caption"}},{"t":"r","msg":"[用紙設定] > [横方向] にチェックを入れ、用紙を横向きにします","in":{"t":"m","v":true,"k":"landscape","or":1,"o":["paper"]}},{"t":"r","msg":"デフォルトのフォントを設定します","in":{"t":"m","v":{},"k":"font"}},{"t":"r","in":{"t":"m","v":13.0,"k":"size","or":1,"o":["font"]}},{"t":"r","msg":"金額を求めるカスタム列を定義します","in":{"t":"aa","v":{},"k":"custom_fields"}},{"t":"r","in":{"t":"m","v":"kingaku","k":"key","or":1,"o":["custom_fields",0]}},{"t":"r","in":{"t":"m","v":"(* .tanka .suryo)","k":"exp","or":1,"o":["custom_fields",0]}},{"t":"g","msg":"部門グループを定義します","c":[],"in":{"t":"m","v":"部門グループ","or":1,"k":"caption"}},{"t":"g","msg":"部門グループを定義します\r\n\r\n[ブレーク条件キー] に \"bumonCd\" と設定することで、\r\n部門コードごとに分割されるグループとすることができます","c":[],"in":{"t":"m","v":["bumonCd"],"or":1,"k":"keys"}},{"t":"g","msg":"部門グループを定義します\r\n\r\n[改ページ] にチェックを入れることで、\r\n部門コードが変わるたびに改ページすることができます","c":[],"in":{"t":"m","v":true,"or":1,"k":"page_break"}},{"t":"c","msg":"ヘッダーを定義します","c":[0],"in":{"t":"m","v":"ヘッダー","or":1,"k":"caption"}},{"t":"c","msg":"ヘッダーを定義します\r\n\r\n高さを110とします","c":[0],"in":{"t":"m","v":{"initial":110.0},"or":1,"k":"size"}},{"t":"c","msg":"ヘッダーを定義します\r\n\r\n全てのページに表示されるように、[毎ページ表示] にチェックを入れます","c":[0],"in":{"t":"m","v":true,"or":1,"k":"every_page"}},{"t":"c","msg":"ヘッダーに要素を配置します","c":[0],"in":{"t":"m","v":[{"text":"部門別売上明細表","type":"text","valign":"center","distribute":true,"halign":"center","font":{"size":20.0,"name":"gothic","underline":false},"layout":{"x1":305.0,"y1":5.0,"x2":505.0,"y2":25.0}},{"type":"line","layout":{"x1":305.0,"y1":25.0,"x2":505.0,"y2":25.0}},{"text":"集計期間：","valign":"center","type":"text","layout":{"x1":250.0,"y1":40.0,"x2":325.0,"y2":55.0}},{"formatter":{"format":"yyyy年MM月dd日","type":"default"},"layout":{"x1":325.0,"y1":40.0,"x2":430.0,"y2":55.0},"type":"field","mock":"t","valign":"center"},{"text":"～","valign":"center","type":"text","halign":"center","layout":{"x1":430.0,"y1":40.0,"x2":450.0,"y2":55.0}},{"formatter":{"format":"yyyy年MM月dd日","type":"default"},"layout":{"x1":450.0,"y1":40.0,"x2":555.0,"y2":55.0},"type":"field","mock":"t","valign":"center"},{"text":"PAGE：","valign":"center","type":"text","halign":"right","layout":{"x1":595.0,"y1":25.0,"x2":695.0,"y2":40.0}},{"layout":{"x1":695.0,"y1":25.0,"x2":802.0,"y2":40.0},"type":"text","halign":"right","valign":"center"},{"text":"印刷日付：","valign":"center","type":"text","halign":"right","layout":{"x1":595.0,"y1":40.0,"x2":695.0,"y2":55.0}},{"mock":"t","formatter":{"format":"yyyy年MM月dd日","type":"default"},"valign":"center","type":"field","halign":"right","layout":{"x1":695.0,"y1":40.0,"x2":802.0,"y2":55.0}},{"layout":{"x1":10.0,"y1":55.0,"x2":430.0,"y2":75.0},"type":"field","mock":"w20","valign":"center"},{"text":"部門：","valign":"center","type":"text","layout":{"x1":10.0,"y1":75.0,"x2":70.0,"y2":95.0}},{"mock":"d4","type":"field","valign":"center","halign":"left","layout":{"x1":70.0,"y1":75.0,"x2":110.0,"y2":95.0},"formatter":{"format":"0000","type":"default"},"exp":".bumonCd","xls_format":"0000"},{"exp":".bumon","layout":{"x1":110.0,"y1":75.0,"x2":430.0,"y2":95.0},"type":"field","mock":"w20","valign":"center"},{"type":"rect","layout":{"x1":10.0,"y1":95.0,"x2":802.0,"y2":110.0}},{"type":"line","layout":{"x1":70.0,"y1":95.0,"x2":70.0,"y2":110.0}},{"type":"line","layout":{"x1":140.0,"y1":95.0,"x2":140.0,"y2":110.0}},{"type":"line","layout":{"x1":220.0,"y1":95.0,"x2":220.0,"y2":110.0}},{"type":"line","layout":{"x1":495.0,"y1":95.0,"x2":495.0,"y2":110.0}},{"type":"line","layout":{"x1":595.0,"y1":95.0,"x2":595.0,"y2":110.0}},{"type":"line","layout":{"x1":695.0,"y1":95.0,"x2":695.0,"y2":110.0}},{"text":"売上日付","valign":"center","type":"text","halign":"center","layout":{"x1":10.0,"y1":95.0,"x2":70.0,"y2":110.0}},{"text":"伝票No.","valign":"center","type":"text","layout":{"x1":70.0,"y1":95.0,"x2":140.0,"y2":110.0}},{"text":"商品コード","valign":"center","type":"text","layout":{"x1":140.0,"y1":95.0,"x2":220.0,"y2":110.0}},{"text":"商品名称","valign":"center","type":"text","layout":{"x1":220.0,"y1":95.0,"x2":495.0,"y2":110.0}},{"text":"単価","valign":"center","type":"text","halign":"right","layout":{"x1":495.0,"y1":95.0,"x2":595.0,"y2":110.0}},{"text":"数量","valign":"center","type":"text","halign":"right","layout":{"x1":595.0,"y1":95.0,"x2":695.0,"y2":110.0}},{"text":"金額","valign":"center","type":"text","halign":"right","layout":{"x1":695.0,"y1":95.0,"x2":802.0,"y2":110.0}}],"or":1,"k":"elements"}},{"md":[],"t":"tr","msg":"会社名、集計期間、印刷日時は、GlobalScopeを通じて帳票に渡されるようにします\r\n\r\nプレビューのデータウィンドウで [global] タブの内容を確認してみてください"},{"md":[{"t":"c","c":[0],"in":{"t":"m","v":"w20","k":"mock","or":1,"o":["elements",10]}},{"t":"c","c":[0],"in":{"t":"m","v":"global.kaisha","k":"exp","or":1,"o":["elements",10]}}],"t":"tr","msg":"会社名を表示する式に \"global.kaisha\" と指定します"},{"t":"c","msg":"集計期間の式に \"global.startDate\"、\"global.endDate\" と指定します","c":[0],"in":{"t":"m","v":"global.startDate","k":"exp","or":1,"o":["elements",3]}},{"t":"c","c":[0],"in":{"t":"m","v":"global.endDate","k":"exp","or":1,"o":["elements",5]}},{"t":"c","msg":"印刷日付の式に \"global.printDate\" と指定します","c":[0],"in":{"t":"m","v":"global.printDate","k":"exp","or":1,"o":["elements",9]}},{"t":"c","msg":"ページ数は （現在のページ数）/(全体のページ数)\r\nという形式で表示するために、[テキスト] の式埋め込み機能を利用して定義します\r\n\r\n[テキスト]に \"#{page_count}/#{page_count.total}\" と指定します","c":[0],"in":{"t":"m","v":"#{page_count}/#{page_count.total}","k":"text","or":1,"o":["elements",7]}},{"t":"gac","msg":"ボディを定義します","g":[]},{"t":"c","c":[1],"in":{"t":"m","v":"ボディ","or":1,"k":"caption"}},{"t":"c","msg":"ボディを定義します\r\n\r\n高さを445とします","c":[1],"in":{"t":"m","v":{"initial":445.0},"or":1,"k":"size"}},{"t":"c","msg":"ボディを定義します\r\n\r\n要素を配置します","c":[1],"in":{"t":"m","v":[{"type":"rect","layout":{"x1":10.0,"y1":0.0,"x2":802.0,"y2":445.0}},{"type":"line","layout":{"x1":70.0,"y1":0.0,"x2":70.0,"y2":445.0}},{"type":"line","layout":{"x1":140.0,"y1":0.0,"x2":140.0,"y2":445.0}},{"type":"line","layout":{"x1":220.0,"y1":0.0,"x2":220.0,"y2":445.0}},{"type":"line","layout":{"x1":495.0,"y1":0.0,"x2":495.0,"y2":445.0}},{"type":"line","layout":{"x1":595.0,"y1":0.0,"x2":595.0,"y2":445.0}},{"type":"line","layout":{"x1":695.0,"y1":0.0,"x2":695.0,"y2":445.0}}],"or":1,"k":"elements"}},{"md":[{"t":"c","c":[1],"in":{"t":"m","v":true,"or":1,"k":"aggregate_src"}},{"t":"cag","c":[1]}],"t":"tr","msg":"明細グループを定義します"},{"t":"g","c":[1],"in":{"t":"m","v":"明細グループ","or":1,"k":"caption"}},{"md":[{"t":"c","c":[1,0],"in":{"t":"m","v":true,"or":1,"k":"aggregate_src"}},{"t":"g","c":[1],"in":{"t":"m","v":true,"or":1,"k":"detail"}}],"t":"tr","msg":"明細グループを定義します\r\n\r\n[明細] にチェックを入れ、明細行が繰り返し表示されるようにします"},{"t":"c","msg":"続いて、明細を定義します","c":[1,0],"in":{"t":"m","v":"明細","or":1,"k":"caption"}},{"t":"c","msg":"続いて、明細を定義します\r\n\r\n高さを15とします","c":[1,0],"in":{"t":"m","v":{"initial":15.0},"or":1,"k":"size"}},{"t":"c","msg":"明細内に要素を配置します","c":[1,0],"in":{"t":"m","v":[{"exp":".uriageDate","formatter":{"format":"yy/MM/dd","type":"default"},"type":"field","layout":{"x1":10.0,"y1":0.0,"x2":70.0,"y2":15.0},"halign":"center","mock":"t","valign":"center"},{"exp":".denpyoNo","formatter":{"format":"00000000","type":"default"},"xls_format":"00000000","layout":{"x1":70.0,"y1":0.0,"x2":140.0,"y2":15.0},"valign":"center","mock":"d8","type":"field"},{"exp":".shohinCd","type":"field","valign":"center","mock":"s8","layout":{"x1":140.0,"y1":0.0,"x2":220.0,"y2":15.0}},{"exp":".shohin","type":"field","valign":"center","mock":"w20","layout":{"x1":220.0,"y1":0.0,"x2":495.0,"y2":15.0}},{"mock":"d10","type":"field","valign":"center","halign":"right","layout":{"x1":495.0,"y1":0.0,"x2":595.0,"y2":15.0},"formatter":{"format":"#,##0","type":"default"},"exp":".tanka","xls_format":"#,###"},{"mock":"d10","type":"field","valign":"center","halign":"right","layout":{"x1":595.0,"y1":0.0,"x2":695.0,"y2":15.0},"formatter":{"format":"#,##0","type":"default"},"exp":".suryo","xls_format":"#,###"},{"mock":"d10","type":"field","valign":"center","halign":"right","layout":{"x1":695.0,"y1":0.0,"x2":802.0,"y2":15.0},"formatter":{"format":"#,##0","type":"default"},"exp":".kingaku","xls_format":"#,###"}],"or":1,"k":"elements"}},{"t":"cig","c":[1],"msg":"伝票グループを定義します"},{"t":"g","c":[1],"in":{"t":"m","v":"伝票グループ","or":1,"k":"caption"}},{"t":"g","msg":"伝票グループを定義します\r\n\r\n[ブレーク条件キー] に \"denpyoNo\" と指定することで、\r\n伝票番号ごとに分割されるグループになります","c":[1],"in":{"t":"m","v":["denpyoNo"],"or":1,"k":"keys"}},{"t":"c","msg":"コンテントの見出しを伝票ボディとします","c":[1,0],"in":{"t":"m","v":"伝票ボディ","or":1,"k":"caption"}},{"t":"gac","msg":"伝票計を追加するために、伝票フッター1を定義します","g":[1]},{"t":"c","c":[1,1],"in":{"t":"m","v":"伝票フッター1","or":1,"k":"caption"}},{"t":"c","msg":"伝票計を追加するために、伝票フッター1を定義します\r\n\r\n高さを15とします","c":[1,1],"in":{"t":"m","v":{"initial":15.0},"or":1,"k":"size"}},{"t":"c","msg":"伝票計を追加するために、伝票フッター1を定義します\r\n\r\n伝票内に複数の明細が存在する場合のみ表示するために、\r\n[表示条件] に \"(> count 1)\" と指定します","c":[1,1],"in":{"t":"m","v":"(> count 1)","or":1,"k":"visibility_cond"}},{"t":"c","msg":"伝票フッター1に要素を配置します","c":[1,1],"in":{"t":"m","v":[{"type":"text","layout":{"x1":595.0,"y1":0.0,"x2":695.0,"y2":15.0},"valign":"center","halign":"right","text":"【伝票計】"},{"xls_format":"#,###","formatter":{"format":"#,##0","type":"default"},"type":"field","layout":{"x1":695.0,"y1":0.0,"x2":802.0,"y2":15.0},"halign":"right","mock":"d10","valign":"center"}],"or":1,"k":"elements"}},{"t":"c","msg":"伝票計を得る式は \"sum.kingaku\" となります","c":[1,1],"in":{"t":"m","v":"sum.kingaku","k":"exp","or":1,"o":["elements",1]}},{"t":"gac","msg":"伝票の区切り線を追加するために、伝票フッター2を定義します","g":[1]},{"t":"c","c":[1,2],"in":{"t":"m","v":"伝票フッター2","or":1,"k":"caption"}},{"t":"c","msg":"伝票の区切り線を追加するために、伝票フッター2を定義します\r\n\r\n高さを5とします","c":[1,2],"in":{"t":"m","v":{"initial":5.0},"or":1,"k":"size"}},{"md":[],"t":"tr","msg":"伝票の区切り線を追加するために、伝票フッター2を定義します\r\n\r\n区切り線は常に表示したいので、\r\n[表示条件] には何も指定しません"},{"t":"c","msg":"伝票の区切り線を追加するために、伝票フッター2を定義します\r\n\r\n[直線] を追加します","c":[1,2],"in":{"t":"aa","v":{"type":"line","layout":{"x1":10.0,"y1":5.0,"x2":802.0,"y2":5.0}},"k":"elements"}},{"t":"c","msg":"部門計を求める式は \"sum.kingaku\" となります","c":[1,1],"in":{"t":"m","v":"sum.kingaku","k":"exp","or":1,"o":["elements",1]}},{"t":"c","msg":"伝票計の直前で改ページされてしまうことを防ぐために、\r\n伝票ボディの[改ページ禁止]にチェックを入れます","c":[1,0],"in":{"t":"m","v":true,"or":1,"k":"unbreakable"}},{"t":"c","msg":"同様に、区切り線の直前で改ページされることの内容に、\r\n伝票フッター1の[改ページ禁止]にチェックを入れます","c":[1,1],"in":{"t":"m","v":true,"or":1,"k":"unbreakable"}},{"md":[{"t":"es","c":[1,0,0],"i":[0,1],"in":{"t":"m","v":"state.first","or":1,"k":"visibility_cond"}}],"t":"tr","msg":"売上日付と伝票Noは、伝票内で最初の明細でのみ表示するために、\r\n[表示条件] に \"state.first\" と指定します"},{"t":"cig","c":[1],"msg":"部門計を追加するために、グループを挿入します"},{"t":"c","c":[1,0],"in":{"t":"m","v":"部門ボディ","or":1,"k":"caption"}},{"t":"gac","msg":"部門フッターを定義します","g":[1]},{"t":"c","c":[1,1],"in":{"t":"m","v":"部門フッター","or":1,"k":"caption"}},{"t":"c","msg":"部門フッターを定義します\r\n\r\n高さを15とします","c":[1,1],"in":{"t":"m","v":{"initial":15.0},"or":1,"k":"size"}},{"t":"c","msg":"部門フッターを定義します\r\n\r\n部門フッターは、部門内に複数の伝票が含まれていた場合のみ表示とするために、[表示条件] に \"(> count# 1)\" と指定します。\r\n\r\n※ #を付ける必要があることに注意してください。付けなかった場合、伝票に含まれる明細数がカウントされます。","c":[1,1],"in":{"t":"m","v":"(> count# 1)","or":1,"k":"visibility_cond"}},{"t":"c","msg":"部門フッターに要素を配置します","c":[1,1],"in":{"t":"m","v":[{"type":"text","layout":{"x1":595.0,"y1":0.0,"x2":695.0,"y2":15.0},"valign":"center","halign":"right","text":"【部門計】"},{"xls_format":"#,###","formatter":{"format":"#,##0","type":"default"},"type":"field","layout":{"x1":695.0,"y1":0.0,"x2":802.0,"y2":15.0},"halign":"right","mock":"d10","valign":"center"}],"or":1,"k":"elements"}},{"md":[],"t":"tr","msg":"以上で完成です\r\n\r\nおつかれさまでした"}],"dt":{"page":[],"global":[{"value":"2013/02/01","key":"startDate"},{"value":"2013/02/28","key":"endDate"},{"value":"2013/03/01","key":"printDate"},{"value":"株式会社システムベース","key":"kaisha"}],"data":{"[root]":{"cols":["bumonCd","bumon","uriageDate","denpyoNo","shohinCd","shohin","tanka","suryo"],"data":[["1","第一営業部","2013/02/01","1246","PC00001","ノートパソコン","70000","10"],["1","第一営業部","2013/02/01","1246","DP00002","モニター","25000","10"],["1","第一営業部","2013/02/01","1246","PR00003","プリンタ","20000","2"],["1","第一営業部","2013/02/10","1248","PR00003","プリンタ","20000","3"],["2","第二営業部","2013/02/01","1247","PC00001","ノートパソコン","70000","5"],["2","第二営業部","2013/02/01","1247","DP00002","モニター","25000","10"]]}}},"bs":{"group":{"contents":[{}]},"paper":{"type":"a4","scale_unit":"point","margin":{"top":20.0,"right":20.0,"left":20.0,"bottom":20.0}}},"lt":true}
